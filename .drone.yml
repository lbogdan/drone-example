---
kind: pipeline
name: build

steps:
  - name: show environment
    image: node:10.16.3-jessie
    commands:
      - printenv

  - name: build and push image
    image: plugins/docker
    settings:
      repo: lbogdan/drone-example
      tags:
      - latest
      - ${DRONE_TAG}
      username: lbogdan
      password:
        from_secret: docker-password

trigger:
  # event: push
  # branch: main
  ref:
    - refs/tags/v*
  event:
    exclude:
      - promote
---
kind: pipeline
name: deploy

steps:
  - name: show environment
    image: node:10.16.3-jessie
    commands:
      - printenv

trigger:
  event:
    - promote
---
kind: signature
hmac: d5f4d0e566496030d564d523551bc2c8c4ef2d2acb8402244ea2edd339e6b898

...
